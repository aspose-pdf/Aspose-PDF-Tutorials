---
"description": "Aspose.PDF for .NET を使用して、タイムスタンプ付きのPDFにデジタル署名する方法を学びましょう。このステップバイステップガイドでは、前提条件、証明書の設定、タイムスタンプの付与などについて説明します。"
"linktitle": "PDFファイルにタイムスタンプでデジタル署名する"
"second_title": "Aspose.PDF for .NET API リファレンス"
"title": "PDFファイルにタイムスタンプでデジタル署名する"
"url": "/ja/net/programming-with-security-and-signatures/digitally-sign-with-time-stamp/"
"weight": 50
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# PDFファイルにタイムスタンプでデジタル署名する

## 導入

セキュリティ強化のため、PDFにデジタル署名とタイムスタンプを追加したいと思ったことはありませんか？法務文書、契約書など、安全な認証が必要な文書を作成する場合、タイムスタンプ付きのデジタル署名は信頼性をさらに高めます。このチュートリアルでは、Aspose.PDF for .NETを使ってPDFにデジタル署名とタイムスタンプを追加する方法を詳しく説明します。ご安心ください。手順を一つずつ解説していきます！

## 前提条件

コードの説明に入る前に、いくつか準備しておく必要があります。始めるための前提条件を簡単にまとめたチェックリストを以下に示します。

- Aspose.PDF for .NET ライブラリ: プロジェクトに Aspose.PDF for .NET ライブラリがインストールされている必要があります。 [最新バージョンはこちらからダウンロードしてください](https://releases.aspose.com/pdf/net/) または、NuGet 経由でプロジェクトに追加します。
- PDFドキュメント：作業にはサンプルPDFファイルが必要です。署名したいファイルがプロジェクトのディレクトリにあることを確認してください。
- デジタル証明書（PFXファイル）：デジタル証明書（ `.pfx` ファイル) を使用してドキュメントにデジタル署名します。
- タイムスタンプ URL: これは、デジタル署名にタイムスタンプを添付するために使用されるオンライン タイムスタンプ サービスです。 
- 基本的な C# の知識: 専門家である必要はありませんが、C# の基礎を知っておくと、コードを理解してカスタマイズするのに役立ちます。

これらすべてのボックスにチェックを入れたら、コーディングを開始する準備が整います。

## パッケージのインポート

まず、以下の名前空間をC#プロジェクトにインポートする必要があります。これにより、関連するAspose.PDFのクラスと関数にアクセスできるようになります。

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Facades;
using Aspose.Pdf.Forms;
using System.Collections;
```

## ステップ1: PDFドキュメントを読み込む

まず最初に、署名したいPDF文書を読み込みましょう。手順は以下のとおりです。

```csharp
// ドキュメントディレクトリへのパスを定義する
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// PDF文書を読み込む
Document document = new Document(dataDir + @"DigitallySign.pdf");
```

このステップは非常に簡単です。署名したい文書へのパスを定義するだけです。 `Document` Aspose.PDF のクラスがファイルの読み込みを処理します。

## ステップ2：デジタル署名を設定する

次に、PKCS7クラスを使用してデジタル署名を作成し、PFXファイルを読み込みます。このPFXファイルには、ドキュメントへの署名に必要な証明書と秘密鍵が含まれています。

```csharp
// .pfx ファイルへのパス
string pfxFile = "YOUR DOCUMENTS DIRECTORY\\certificate.pfx";

// 署名オブジェクトを初期化する
PdfFileSignature signature = new PdfFileSignature(document);

// パスワード付きのPFXファイルを読み込む
PKCS7 pkcs = new PKCS7(pfxFile, "pfx_password");
```

この時点で、Asposeに文書の署名にデジタル証明書を使用するように指示します。 `PKCS7` オブジェクトはすべての暗号化作業を処理するため、細かい詳細について心配する必要はありません。

## ステップ3: タイムスタンプ設定を追加する

堅牢なデジタル署名の重要な要素の一つはタイムスタンプです。これにより、証明書の有効期限が切れた後でも、文書の署名を検証できるようになります。オンラインのタイムスタンプ認証機関を利用して、タイムスタンプを設定してみましょう。

```csharp
// タイムスタンプ設定を定義する
TimestampSettings timestampSettings = new TimestampSettings("https://your_timestamp_url", "ユーザー:パスワード");

// PKCS7オブジェクトにタイムスタンプ設定を追加する
pkcs.TimestampSettings = timestampSettings;
```

ここでは、タイムスタンプサービスのURLを指定します。これにより、署名に日付と時刻が自動的に付加されます。認証の有無は問いません。

## ステップ4: 署名の場所と外観を定義する

次に、PDF内で署名を表示する場所とサイズを定義します。署名ボックスの位置とサイズをカスタマイズできます。

```csharp
// 署名の外観と位置を定義します（ページ 1、指定された長方形）
System.Drawing.Rectangle rect = new System.Drawing.Rectangle(100, 100, 200, 100);
```

ここでは、PDF の最初のページの座標 (100, 100) に署名を配置し、幅を 200、高さを 100 とする四角形を定義しています。これらの値はデザインに合わせて変更できます。

## ステップ5: PDF文書に署名する

すべての設定が完了したら、PDFにデジタル署名を実際に適用します。この手順では、証明書、タイムスタンプ、位置情報を1つのシンプルなコマンドにまとめます。

```csharp
// 書類の最初のページに署名する
signature.Sign(1, "Signature Reason", "Contact", "Location", true, rect, pkcs);
```

何が起こっているかは以下のとおりです:
- 1: 署名を最初のページに適用することを示します。
- 「署名理由」: ここで、文書に署名する理由を指定できます。
- 「連絡先」：署名者の連絡先情報を入力します。
- 「場所」: 署名者の場所を指定します。
- true: このブール値は、署名がドキュメントに表示されるかどうかを示します。
- rect: 先ほど定義した四角形は、署名のサイズと位置を指定します。
- pkcs: PKCS7 オブジェクトには、デジタル証明書とタイムスタンプの設定が含まれています。

## ステップ6: 署名されたPDFを保存する

文書に署名が完了したら、あとは保存するだけです。新しいファイル名を選択して、元の文書と署名済み文書の両方を保存することもできます。

```csharp
// 署名されたPDF文書を保存する
signature.Save(dataDir + "DigitallySignWithTimeStamp_out.pdf");
```

新しく署名され、タイムスタンプが付けられた PDF が指定されたディレクトリに保存されました。

## 結論

これで完了です！Aspose.PDF for .NET を使って、タイムスタンプ付きのPDFにデジタル署名を付与できました。このプロセスにより、ドキュメントの真正性と整合性が確保され、作成者と受信者の両方に安心感を与えます。デジタル署名は今日のデジタル世界においてますます重要になってきており、このプロセスを習得することは間違いなく価値のあるスキルです。

## よくある質問

### 証明書に別のファイル形式を使用できますか?  
はい、ただし、このチュートリアルでは、デジタル証明書で最も一般的な形式である PFX ファイルの使用に重点を置いています。

### タイムスタンプを適用するにはインターネット接続が必要ですか?  
はい、タイムスタンプはオンラインのタイムスタンプ機関から取得されるため、インターネット アクセスが必要になります。

### PDF 内の複数のページに署名できますか?  
もちろんです！ `signature.Sign()` 複数のページを対象にしたり、すべてのページをループしたりするメソッド。

### PFX ファイルのパスワードが間違っているとどうなりますか?  
パスワードが間違っていると例外が発生するので、正しく入力されていることを確認してください。

### 署名を非表示にすることはできますか?  
はい、合格できます `false` に `Sign` メソッドの可視性パラメータを使用して、署名を非表示にします。

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}