---
category: general
date: 2026-02-14
description: Легко добавляйте нумерацию Бейтса в PDF‑документы. Узнайте, как добавить
  номера страниц в нижний колонтитул и последовательную нумерацию PDF с помощью Aspose.Pdf
  за считанные минуты.
draft: false
keywords:
- add bates numbering pdf
- add footer page numbers
- how to add bates numbers
- add sequential numbers pdf
language: ru
og_description: Быстро добавьте Бейтс‑нумерацию в PDF. Это руководство показывает,
  как добавить номера страниц в нижний колонтитул и последовательные номера в PDF
  с помощью Aspose.Pdf, предоставляя полный код и советы.
og_title: Добавление нумерации Бейтса в PDF – пошаговое руководство по C#
tags:
- Aspose.Pdf
- C#
- PDF automation
title: Добавить нумерацию Бейтса в PDF – Полное руководство по C#
url: /ru/net/programming-with-stamps-and-watermarks/add-bates-numbering-pdf-complete-c-guide/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Добавление нумерации Бейтса в PDF – Полное руководство на C#  

Когда‑нибудь вам нужно было **add Bates numbering PDF** файлы, но вы не знали, с чего начать? Вы не одиноки. Юридические команды, аудиторы и любые люди, работающие с большими наборами документов, постоянно спрашивают: «Как добавить Bates numbers без нарушения макета?» Хорошая новость в том, что с Aspose.Pdf for .NET вы можете внедрить эти номера в виде простого нижнего колонтитула — без ручного редактирования.

В этом руководстве мы пройдем практическое решение «от начала до конца», которое не только **adds footer page numbers**, но и позволяет **add sequential numbers PDF** файлы с пользовательским префиксом, размером шрифта и выравниванием. К концу вы получите готовую к запуску программу на C#, чёткое понимание, почему каждое настройка важна, и несколько профессиональных советов, чтобы избежать самых распространённых подводных камней.

## Что вы узнаете

- Как загрузить существующий PDF и подготовить его к нумерации Бейтса.  
- Какие свойства **BatesNumberingOptions** управляют внешним видом и размещением.  
- Как применить нумерацию ко всем страницам одним вызовом.  
- Способы настройки префикса, начального номера и полей для разных юридических форматов.  
- Обработка крайних случаев — что делать с зашифрованными PDF или документами, уже содержащими нижние колонтитулы.  

**Prerequisites**: .NET 6+ (или .NET Framework 4.7+), последняя версия Aspose.Pdf (в примере используется 23.10) и исходный PDF, права на изменение которого у вас есть. Другие сторонние библиотеки не требуются.

---

## Шаг 1 – Загрузите PDF, который хотите пронумеровать

Первое, что мы делаем, — создаём экземпляр `Document`, указывающий на исходный файл. Использование шаблона `using var` гарантирует автоматическое освобождение дескриптора файла.

```csharp
using Aspose.Pdf;

// Replace with the path to your source PDF
using var doc = new Document("YOUR_DIRECTORY/input.pdf");
```

> **Why this matters:** Aspose.Pdf читает всю структуру PDF в память, позволяя нам манипулировать страницами, аннотациями и метаданными, не трогая оригинальный файл на диске. Если PDF защищён паролем, вы можете передать пароль в конструктор — см. примечание «Encrypted PDFs» в конце.

---

## Шаг 2 – Определите параметры нумерации Бейтса

Bates numbers по сути являются нижними колонтитулами страниц с настраиваемым префиксом и последовательным счётчиком. Класс `BatesNumberingOptions` позволяет точно настроить каждый визуальный аспект.

```csharp
var batesOptions = new BatesNumberingOptions
{
    // The text that will appear before the numeric part
    Prefix = "ABC-",

    // Starting number; the library will increment this automatically
    StartNumber = 1000,

    // Font size of the footer text (points)
    FontSize = 12,

    // Align the number to the right side of the page
    HorizontalAlignment = HorizontalAlignment.Right,

    // Place the number at the bottom of the page
    VerticalAlignment = VerticalAlignment.Bottom,

    // Margins: left, top, right, bottom (in points)
    Margin = new MarginInfo(0, 20, 0, 0)
};
```

### Быстрый совет

- **Prefix**: Используйте короткий уникальный идентификатор (например, номер дела), чтобы нижний колонтитул оставался читаемым.  
- **StartNumber**: Юридические фирмы часто начинают с `1` или с пользовательского смещения; выбирайте то, что соответствует вашей системе учёта.  
- **Margins**: Нижнее поле в `20` пунктов сохраняет текст подальше от сносок или подписей, которые могут уже находиться у края страницы.

---

## Шаг 3 – Примените нумерацию ко всем страницам

С настроенными параметрами фактическая вставка происходит в одну строку кода. Aspose.Pdf автоматически обрабатывает нумерацию страниц, обновляет существующие потоки содержимого и учитывает поворот страницы.

```csharp
doc.Pages.AddBatesNumbering(batesOptions);
```

> **What’s happening under the hood?** Библиотека проходит по каждому объекту `Page`, создаёт `TextFragment`, включающий префикс и текущий счётчик, затем рисует его, используя систему координат страницы. Поскольку мы задали `HorizontalAlignment.Right` и `VerticalAlignment.Bottom`, текст привязывается к нижнему‑правому углу независимо от размера страницы.

---

## Шаг 4 – Сохраните изменённый PDF

Наконец, запишите результат в новый файл. Перезаписать оригинал возможно, но сохранение копии упрощает контроль версий.

```csharp
doc.Save("YOUR_DIRECTORY/output.pdf");
```

Если необходимо сохранить оригинальные метаданные (автор, дата создания), Aspose.Pdf копирует их по умолчанию. Вы также можете указать объект `SaveOptions` для соответствия PDF/A или сжатия.

---

## Полный рабочий пример

Ниже представлен полный, готовый к запуску пример программы. Вставьте его в проект консольного приложения, скорректируйте пути к файлам и нажмите **F5**.

```csharp
using Aspose.Pdf;

class Program
{
    static void Main()
    {
        // 1️⃣ Load the source PDF
        using var doc = new Document("YOUR_DIRECTORY/input.pdf");

        // 2️⃣ Configure Bates numbering options
        var batesOptions = new BatesNumberingOptions
        {
            Prefix = "ABC-",
            StartNumber = 1000,
            FontSize = 12,
            HorizontalAlignment = HorizontalAlignment.Right,
            VerticalAlignment = VerticalAlignment.Bottom,
            Margin = new MarginInfo(0, 20, 0, 0)
        };

        // 3️⃣ Apply numbering to every page
        doc.Pages.AddBatesNumbering(batesOptions);

        // 4️⃣ Save the output PDF
        doc.Save("YOUR_DIRECTORY/output.pdf");

        System.Console.WriteLine("Bates numbering added successfully!");
    }
}
```

**Expected result:** Каждая страница `output.pdf` теперь отображает нижний колонтитул вида `ABC-1000`, `ABC-1001`, … привязанный к нижнему‑правому углу. Откройте файл в любом PDF‑просмотрщике, чтобы проверить.

---

## Обработка распространённых вариантов

### Добавление только номеров страниц в нижний колонтитул

Если вам нужны только простые номера страниц без префикса, установите `Prefix = ""` и, возможно, скорректируйте поле, чтобы избежать столкновения с существующими нижними колонтитулами.

```csharp
batesOptions.Prefix = "";
batesOptions.StartNumber = 1; // classic page numbering
```

### Использование другого выравнивания

В юридических документах иногда требуется центрировать номер внизу. Измените выравнивание:

```csharp
batesOptions.HorizontalAlignment = HorizontalAlignment.Center;
```

### Работа с зашифрованными PDF

Когда исходный PDF защищён паролем, передайте пароль следующим образом:

```csharp
using var doc = new Document("secure.pdf", new LoadOptions { Password = "mySecret" });
```

Остальная часть рабочего процесса остаётся идентичной.

### Пропуск существующих нижних колонтитулов

Если документ уже содержит нижний колонтитул, который вы не хотите перезаписывать, вы можете добавить перед ним пользовательскую строку, делая новый номер отличным, либо вручную пройтись по страницам и добавить `TextFragment` только там, где колонтитул отсутствует. Класс `Page` библиотеки предоставляет коллекции `Annotations` и `Contents` для детального управления.

---

## Профессиональные советы и подводные камни

- **Avoid clipping**: Очень маленькие нижние поля могут привести к обрезке текста на принтере. Проверьте на физической печати, если планируете распространять бумажные копии.  
- **Performance**: Добавление нумерации Бейтса в PDF из 500 страниц занимает менее секунды на современном ноутбуке, но большие партии выигрывают от параллельной обработки — только помните, что `Document` не является потокобезопасным, поэтому каждый поток должен иметь свой экземпляр.  
- **Version compatibility**: Код работает с Aspose.Pdf 23.10 и новее. Если вы используете более старую версию, имена свойств одинаковы, но конструктор `MarginInfo` может требовать аргументы типа `float`.  
- **Legal compliance**: В некоторых юрисдикциях требуется размещать номер Бейтса в определённом месте (например, снизу‑слева). Соответственно настройте `HorizontalAlignment`.

---

## Заключение

Мы только что продемонстрировали, как **add Bates numbering PDF** файлы с помощью Aspose.Pdf for .NET, охватив всё от загрузки документа до сохранения финальной версии с чистым нижним колонтитулом. Путём настройки нескольких свойств вы также можете **add footer page numbers**, **add sequential numbers PDF**, либо настроить внешний вид в соответствии с любым юридическим стандартом.

Готовы к следующему шагу? Попробуйте сочетать эту технику с извлечением текста OCR, чтобы внедрить поисковые ключевые слова рядом с вашими номерами Бейтса, или автоматизировать процесс для целых папок, используя `Directory.GetFiles`. Возможности безграничны, а полученная база упростит любые дальнейшие расширения.

Удачной разработки, и пусть ваши PDF всегда будут идеально пронумерованы!

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}