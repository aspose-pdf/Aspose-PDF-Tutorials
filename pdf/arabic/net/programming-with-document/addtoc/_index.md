---
"description": "تعرّف على كيفية إضافة جدول محتويات إلى ملف PDF باستخدام Aspose.PDF لـ .NET. يُبسّط هذا الدليل المُفصّل العملية ويضمن سهولة التنقل داخل مستنداتك."
"linktitle": "إضافة جدول المحتويات إلى ملف PDF"
"second_title": "مرجع Aspose.PDF لـ API .NET"
"title": "إضافة جدول المحتويات إلى ملف PDF"
"url": "/ar/net/programming-with-document/addtoc/"
"weight": 40
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# إضافة جدول المحتويات إلى ملف PDF

## مقدمة

هل سبق لك أن تصفحت ملف PDF طويلًا دون توقف، متمنيًا لو كان جدول محتوياته منظمًا جيدًا؟ حسنًا، اليوم هو يومك المحظوظ! في هذا البرنامج التعليمي، ستتعلم كيفية إضافة جدول محتويات إلى ملف PDF باستخدام Aspose.PDF لـ .NET. سواء كنت تعمل على تقرير معقد، أو كتاب إلكتروني، أو مقترح عمل، يمكن لجدول المحتويات أن يحوّل مستندك إلى تحفة فنية احترافية وسهلة التصفح.

## المتطلبات الأساسية

قبل أن ننتقل إلى الكود، دعنا نتأكد من أنك حصلت على كل ما تحتاجه:

1. Aspose.PDF لـ .NET: تأكد من تنزيل مكتبة Aspose.PDF وتثبيتها. يمكنك تنزيلها من [هنا](https://releases.aspose.com/pdf/net/).
   
2. بيئة التطوير: تأكد من أن لديك بيئة تطوير .NET مثل Visual Studio مثبتة على جهازك.

3. الترخيص: إذا لم يكن لديك ترخيص، يمكنك الحصول على نسخة تجريبية مجانية أو طلب ترخيص مؤقت [هنا](https://purchase.aspose.com/temporary-license/).

## استيراد الحزم

للبدء، تأكد من استيراد مساحات الأسماء اللازمة في بداية ملف الكود. إليك الطريقة:

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Text;
```

تتيح لك مساحات الأسماء هذه الوصول إلى وظائف محددة لملف PDF ومعالجة عناصر النص داخل مستندك.

لنُقسّم هذه المهمة إلى خطوات مُختصرة. ستُرشدك كل خطوة خلال عملية إنشاء جدول المحتويات وإدراجه في مستند PDF.

## الخطوة 1: تحميل مستند PDF

أول شيء يتعين علينا القيام به هو تحميل ملف PDF الموجود حيث نريد إضافة جدول المحتويات.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "AddTOC.pdf");
```

في هذه الخطوة، نحدد المسار إلى دليل المستند ونقوم بتحميل ملف PDF باستخدام `Document` الكائن. تأكد من استبداله `"YOUR DOCUMENT DIRECTORY"` مع المسار الفعلي لملفك.

## الخطوة 2: إدراج صفحة جديدة لجدول المحتويات

بعد ذلك، نضيف صفحة جديدة في بداية مستند PDF. ستحتوي هذه الصفحة على جدول المحتويات.

```csharp
Page tocPage = doc.Pages.Insert(1);
```

من خلال إدراج صفحة جدول المحتويات في البداية، فإننا نضمن ظهورها كأول شيء يراه القراء في ملف PDF.

## الخطوة 3: إنشاء كائن معلومات جدول المحتويات

الآن، لنُنشئ كائنًا يُمثل معلومات جدول المحتويات. سنُضيف أيضًا عنوانًا لجدول المحتويات لإبرازه.

```csharp
TocInfo tocInfo = new TocInfo();
TextFragment title = new TextFragment("Table Of Contents");
title.TextState.FontSize = 20;
title.TextState.FontStyle = FontStyles.Bold;
tocInfo.Title = title;
tocPage.TocInfo = tocInfo;
```

هنا، قمنا بتعيين عنوان جدول المحتويات كـ "جدول المحتويات"، وزدنا حجم الخط، وجعلناه غامقًا للتأكيد.

## الخطوة 4: تحديد عناصر جدول المحتويات

في هذه الخطوة، نُحدد العناصر (أو العناوين) التي ستظهر في جدول المحتويات. ستساعد هذه العناصر القراء على التنقل بين أقسام محددة من المستند.

```csharp
string[] titles = new string[4];
titles[0] = "First page";
titles[1] = "Second page";
titles[2] = "Third page";
titles[3] = "Fourth page";
```

لقد قمنا بإنشاء مجموعة من السلاسل التي ستكون بمثابة عناصر جدول المحتويات لدينا، والتي تتوافق مع الصفحات المختلفة في ملف PDF.

## الخطوة 5: إنشاء عناوين جدول المحتويات

الآن يأتي الجزء الحاسم - إضافة العناوين إلى جدول المحتويات وربطها بالصفحات الخاصة بها.

```csharp
for (int i = 0; i < 2; i++)
{
    Aspose.Pdf.Heading heading2 = new Aspose.Pdf.Heading(1);
    TextSegment segment2 = new TextSegment();
    heading2.TocPage = tocPage;
    heading2.Segments.Add(segment2);

    heading2.DestinationPage = doc.Pages[i + 2];
    heading2.Top = doc.Pages[i + 2].Rect.Height;
    segment2.Text = titles[i];

    tocPage.Paragraphs.Add(heading2);
}
```

وإليك ما يحدث:
- العنوان: نحن ننشئ `Heading` الكائن وإضافة `TextSegment` إليها.
- صفحة الوجهة: قمنا بتعيين الصفحة التي سيرتبط بها كل عنوان.
- الموضع العلوي: نحدد الموضع في الصفحة الذي سيشير إليه العنوان.
- النص: يحصل كل عنوان على عنوانه الخاص من المصفوفة التي أنشأناها سابقًا.

تعمل هذه الحلقة على إنشاء عناوين للعنصرين الأولين في جدول المحتويات وربطهما بالصفحات المقابلة.

## الخطوة 6: احفظ ملف PDF مع جدول المحتويات

أخيرًا، بعد أن أضفنا جميع عناصر جدول المحتويات، حان الوقت لحفظ ملف PDF المحدث.

```csharp
dataDir = dataDir + "TOC_out.pdf";
doc.Save(dataDir);
```

تم الآن حفظ الملف مع إضافة جدول المحتويات إلى ملف PDF. تهانينا، لقد أضفت جدول المحتويات بنجاح!

## الخطوة 7: رسالة التأكيد

لإعلام المستخدم بأن العملية قد اكتملت، سنعرض رسالة بسيطة في وحدة التحكم.

```csharp
Console.WriteLine("\nTOC added successfully to an existing PDF.\nFile saved at " + dataDir);
```

## خاتمة

وهذا كل ما في الأمر! مع Aspose.PDF لـ .NET، أصبحت إضافة جدول محتويات إلى ملف PDF سهلةً وقابلةً للتخصيص أيضًا. سواءً كنتَ بحاجة إلى إنشاء روابط تنقل بسيطة أو هياكل معقدة، فهذه الأداة تُلبي احتياجاتك. لذا، في المرة القادمة التي تعمل فيها على ملف PDF طويل، لا تنسَ إضافة جدول محتويات لإضفاء لمسة احترافية!

## الأسئلة الشائعة

### هل يمكنني تخصيص مظهر جدول المحتويات في Aspose.PDF؟  
نعم، يمكنك تخصيص مظهر جدول المحتويات بالكامل، بما في ذلك نمط الخط وحجمه ومحاذاته.

### كيف أضيف عناوين فرعية إلى جدول المحتويات؟  
يمكنك إضافة عناوين فرعية عن طريق تعديل `Heading` المستوى (على سبيل المثال، `Heading(2)`) لإنشاء جدول محتويات هرمي.

### هل من الممكن تحديث جدول المحتويات تلقائيًا إذا تغيرت الوثيقة؟  
لا، لن يتم تحديث جدول المحتويات تلقائيًا. ستحتاج إلى إعادة إنشائه إذا تغير هيكل المستند.

### هل يمكنني ربط إدخالات جدول المحتويات بمستندات خارجية؟  
نعم، يمكنك استخدام الارتباطات التشعبية لربط إدخالات جدول المحتويات بملفات PDF أو عناوين URL خارجية.

### هل يدعم Aspose.PDF جداول المحتويات متعددة المستويات؟  
نعم، يدعم Aspose.PDF جداول المحتويات متعددة المستويات للمستندات المعقدة التي تحتوي على أقسام فرعية.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}