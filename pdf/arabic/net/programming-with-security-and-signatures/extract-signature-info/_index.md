---
"description": "تعلّم كيفية استخراج التوقيعات الرقمية ومعلومات الشهادات من مستندات PDF باستخدام Aspose.PDF لـ .NET. دليل شامل خطوة بخطوة لمطوري C#."
"linktitle": "استخراج معلومات التوقيع"
"second_title": "مرجع Aspose.PDF لـ API .NET"
"title": "استخراج معلومات التوقيع"
"url": "/ar/net/programming-with-security-and-signatures/extract-signature-info/"
"weight": 80
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# استخراج معلومات التوقيع

## مقدمة

في عالمنا الرقمي اليوم، يُعد ضمان أمان وسلامة المستندات أمرًا بالغ الأهمية. ومن الطرق الشائعة لتأمين ملفات PDF إضافة توقيع رقمي. ومع ذلك، قد يُشكل استرداد تفاصيل التوقيع والتحقق منها تحديًا في بعض الأحيان، خاصةً عند التعامل مع شهادات متعددة. في هذا الدليل، سنشرح لك عملية استخراج معلومات التوقيع من مستندات PDF باستخدام Aspose.PDF لـ .NET، مما يُسهّل عليك المهمة. ستتعلم كيفية الوصول إلى حقول التوقيع، واستخراج معلومات الشهادة، وحفظها في ملف.

## المتطلبات الأساسية

قبل أن نبدأ، دعونا نتأكد من أن كل شيء جاهز للبدء.

- مكتبة Aspose.PDF لـ .NET: إذا لم تكن لديك بعد، فيمكنك تنزيلها من [صفحة تنزيل Aspose.PDF لـ .NET](https://releases.aspose.com/pdf/net/). 
- بيئة تطوير .NET: ستحتاج إلى بيئة تطوير متكاملة مثل Visual Studio.
- المعرفة الأساسية بلغة C#: إن المعرفة بلغة C# مفيدة لفهم مقتطفات التعليمات البرمجية في هذا البرنامج التعليمي.
- مستند PDF يحتوي على توقيع رقمي: لأغراض الاختبار، تأكد من أن لديك ملف PDF يحتوي على توقيع رقمي واحد على الأقل.

## استيراد مساحات الأسماء المطلوبة

قبل البدء في الكود، من المهم استيراد مساحات الأسماء اللازمة. ستتيح لك هذه المساحات الوصول إلى وظيفة Aspose.PDF والعمل مع مستندات PDF.

```csharp
using System.IO;
using Aspose.Pdf.Forms;
using Aspose.Pdf;
using System;
```

الآن بعد أن قمت بإعداد الأساسيات، دعنا ننتقل إلى العملية الفعلية لاستخراج معلومات التوقيع من ملف PDF.

## الخطوة 1: إعداد دليل المستندات

قبل العمل على مستند PDF، عليك تحديد موقع الملف الذي ستستخدمه. يمكنك استبدال `"YOUR DOCUMENT DIRECTORY"` مع المسار الفعلي للدليل الذي يتم تخزين ملفات PDF الخاصة بك فيه.

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
string input = dataDir + "ExtractSignatureInfo.pdf";
```

هنا، نحدد المجلد الذي يحتوي على ملف PDF واسم الملف نفسه. تأكد من وجود الملف في هذا المجلد!

## الخطوة 2: تحميل مستند PDF

الآن بعد أن قمت بإعداد الدليل الخاص بك، فإن الخطوة التالية هي تحميل مستند PDF باستخدام `Document` الفئة من Aspose.PDF.

```csharp
using (Document pdfDocument = new Document(input))
{
    // قم بمعالجة ملف PDF هنا.
}
```

يقوم هذا السطر من التعليمات البرمجية بتهيئة `Document` الكائن الذي يمثل ملف PDF. `using` تضمن هذه العبارة تنظيف الموارد بعد معالجة المستند.

## الخطوة 3: الوصول إلى حقول النموذج

في هذه الخطوة، سنمرّ عبر جميع حقول النماذج في مستند PDF. بما أن التوقيعات تُخزّن عادةً كحقول نماذج، ستساعدنا هذه الخطوة على تحديد حقول التوقيع.

```csharp
foreach (Field field in pdfDocument.Form)
{
    // قم بتحديد حقول التوقيع هنا.
}
```

من خلال التكرار من خلال `Form` ممتلكات `Document` الكائن، يمكننا فحص كل حقل نموذج للتحقق مما إذا كان حقل توقيع.

## الخطوة 4: تحديد حقول التوقيع

بعد الوصول إلى حقول النموذج، الخطوة التالية هي تحديد حقول التوقيع. يمكننا القيام بذلك عن طريق تحويل كل حقل إلى `SignatureField` هدف.

```csharp
SignatureField sf = field as SignatureField;
if (sf != null)
{
    // استخراج معلومات التوقيع.
}
```

هنا نستخدم `as` كلمة رئيسية لمحاولة تحويل كل حقل نموذج إلى `SignatureField`إذا كان الإرسال ناجحًا، فإننا نعلم أن الحقل هو توقيع.

## الخطوة 5: استخراج الشهادة

بعد تحديد حقل التوقيع، تتمثل المهمة التالية في استخراج الشهادة منه. تحتوي الشهادات على معلومات أساسية حول المُوقّع وصلاحية التوقيع.

```csharp
Stream cerStream = sf.ExtractCertificate();
```

ال `ExtractCertificate` الطريقة تعيد `Stream` كائن يحتوي على بيانات الشهادة. يمكن استخدام هذا الدفق لحفظ الشهادة لمزيد من التحليل أو التخزين.

## الخطوة 6: حفظ الشهادة في ملف

بعد استخراج الشهادة، الخطوة الأخيرة هي حفظها في ملف. في هذه الحالة، سنحفظ الشهادة كملف `.cer` ملف.

```csharp
if (cerStream != null)
{
    using (cerStream)
    {
        byte[] bytes = new byte[cerStream.Length];
        using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
        {
            cerStream.Read(bytes, 0, bytes.Length);
            fs.Write(bytes, 0, bytes.Length);
        }
    }
}
```

في كتلة التعليمات البرمجية هذه، نقوم بما يلي:

1. تحقق مما إذا كان مجرى الشهادة ليس فارغًا.
2. قراءة بيانات الشهادة في مجموعة بايتات.
3. اكتب مجموعة البايتات إلى `.cer` الملف في دليل المستند.

## خاتمة

استخراج التوقيعات الرقمية ومعلومات الشهادات المتعلقة بها من مستندات PDF باستخدام Aspose.PDF لـ .NET سهلٌ للغاية عند تقسيمه إلى خطوات بسيطة. سواءً كنت تُدقّق المستندات، أو تتحقق من التوقيعات، أو تُخزّن الشهادات لحفظها، فإن هذا البرنامج التعليمي يُزوّدك بالمعرفة اللازمة لإنجاز ذلك بكفاءة. تذكّر أن تأمين المستندات والتحقق منها أمرٌ بالغ الأهمية في عالمنا الرقمي اليوم، واستخدام أدوات مثل Aspose.PDF لـ .NET يُسهّل التعامل معها بشكل كبير.

## الأسئلة الشائعة

### هل يمكنني استخراج توقيعات متعددة من ملف PDF باستخدام Aspose.PDF لـ .NET؟
نعم، يتكرر الكود خلال جميع حقول النموذج في المستند، مما يسمح لك باستخراج توقيعات متعددة إذا كانت موجودة.

### ماذا يحدث إذا لم يتم العثور على توقيع في ملف PDF؟
إذا لم تكن هناك حقول توقيع موجودة، فسوف يتخطاها الكود ببساطة دون إثارة خطأ.

### هل يمكنني استخدام هذا النهج للتحقق من صحة التوقيع؟
على الرغم من إمكانية استخراج الشهادة، إلا أن التحقق من صحة التوقيع يتطلب خطوات إضافية، مثل التحقق من سلسلة الثقة الخاصة بالشهادة.

### هل من الممكن استخراج بيانات حقل النموذج الأخرى باستخدام Aspose.PDF لـ .NET؟
نعم، يسمح لك Aspose.PDF بالوصول إلى أنواع مختلفة من حقول النماذج في ملف PDF ومعالجتها، وليس فقط حقول التوقيع.

### كيف يمكنني الاطلاع على تفاصيل الشهادة المستخرجة؟
بمجرد حفظ الشهادة كملف `.cer` الملف، يمكنك فتحه باستخدام أي عارض شهادات أو استيراده إلى مخزن شهادات النظام لمزيد من الفحص.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}