---
"description": "تعرّف على كيفية التوقيع رقميًا على ملف PDF بختم زمني باستخدام Aspose.PDF لـ .NET. يغطي هذا الدليل التفصيلي المتطلبات الأساسية، وإعداد الشهادة، والختم الزمني، والمزيد."
"linktitle": "التوقيع رقميًا باستخدام ختم الوقت في ملف PDF"
"second_title": "مرجع Aspose.PDF لـ API .NET"
"title": "التوقيع رقميًا باستخدام ختم الوقت في ملف PDF"
"url": "/ar/net/programming-with-security-and-signatures/digitally-sign-with-time-stamp/"
"weight": 50
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# التوقيع رقميًا باستخدام ختم الوقت في ملف PDF

## مقدمة

هل سبق لك أن احتجت إلى توقيع ملف PDF رقميًا وإضافة ختم زمني لمزيد من الأمان؟ سواء كنت تعمل على مستندات قانونية أو عقود أو أي شيء يتطلب مصادقة آمنة، فإن التوقيع الرقمي المزود بختم زمني يُضفي مصداقية إضافية. في هذا البرنامج التعليمي، سنشرح بالتفصيل كيفية استخدام Aspose.PDF لـ .NET لإضافة توقيع رقمي وختم زمني إلى مستندات PDF الخاصة بك. لا تقلق، سنشرح لك الأمر خطوة بخطوة!

## المتطلبات الأساسية

قبل أن نتعمق في شرح الكود، هناك بعض الأمور التي ستحتاج إلى إعدادها لمتابعته. إليك قائمة مرجعية سريعة بالمتطلبات الأساسية للبدء:

- مكتبة Aspose.PDF لـ .NET: ستحتاج إلى تثبيت مكتبة Aspose.PDF لـ .NET في مشروعك. يمكنك [قم بتنزيل الإصدار الأحدث هنا](https://releases.aspose.com/pdf/net/) أو قم بإضافته إلى مشروعك عبر NuGet.
- مستند PDF: ستحتاج إلى ملف PDF نموذجي للعمل عليه. تأكد من وجود ملف في مجلد مشروعك ترغب في توقيعه.
- الشهادة الرقمية (ملف PFX): تأكد من حصولك على شهادة رقمية (ملف PFX) `.pfx` الملف) للتوقيع رقميا على المستند.
- ختم التاريخ على عنوان URL: هذه خدمة ختم التاريخ على الإنترنت والتي سيتم استخدامها لإرفاق ختم التاريخ بالتوقيع الرقمي. 
- المعرفة الأساسية بلغة C#: لا يلزمك أن تكون خبيرًا، ولكن معرفة أساسيات لغة C# سوف تساعدك على فهم الكود وتخصيصه.

بمجرد تحديد كل هذه المربعات، ستكون جاهزًا لبدء الترميز!

## استيراد الحزم

للبدء، ستحتاج إلى استيراد مساحات الأسماء التالية إلى مشروع C# الخاص بك. هذا يضمن لك الوصول إلى فئات ووظائف Aspose.PDF ذات الصلة.

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Facades;
using Aspose.Pdf.Forms;
using System.Collections;
```

## الخطوة 1: تحميل مستند PDF

أول ما علينا فعله هو تحميل ملف PDF الذي نريد توقيعه. إليك الطريقة:

```csharp
// حدد المسار إلى دليل المستند الخاص بك
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// تحميل مستند PDF
Document document = new Document(dataDir + @"DigitallySign.pdf");
```

هذه الخطوة بسيطة جدًا. ما نقوم به ببساطة هو تحديد مسار المستند الذي نريد توقيعه. `Document` تتولى الفئة من Aspose.PDF عملية تحميل الملف.

## الخطوة 2: إعداد التوقيع الرقمي

بعد ذلك، سننشئ التوقيع الرقمي باستخدام فئة PKCS7 ونحمّل ملف PFX. يحتوي هذا الملف على شهادتك ومفتاحك الخاص، وهما ضروريان لتوقيع المستند.

```csharp
// المسار إلى ملف .pfx الخاص بك
string pfxFile = "YOUR DOCUMENTS DIRECTORY\\certificate.pfx";

// تهيئة كائن التوقيع
PdfFileSignature signature = new PdfFileSignature(document);

// قم بتحميل ملف PFX بكلمة مرور
PKCS7 pkcs = new PKCS7(pfxFile, "pfx_password");
```

في هذه المرحلة، أنت تطلب من Aspose استخدام شهادتك الرقمية لتوقيع المستند. `PKCS7` يتولى الكائن التعامل مع كافة أعمال التشفير نيابةً عنك، لذا لا داعي للقلق بشأن التفاصيل الدقيقة.

## الخطوة 3: إضافة إعدادات الطابع الزمني

يُعدّ ختم التاريخ أحد المكونات الرئيسية لتوقيع رقمي قوي. فهو يضمن إمكانية التحقق من توقيع المستند حتى بعد انتهاء صلاحية الشهادة. لنبدأ بإعداد ختم التاريخ باستخدام جهة إصدار ختم تاريخ إلكتروني.

```csharp
// تحديد إعدادات الطابع الزمني
TimestampSettings timestampSettings = new TimestampSettings("https://عنوان URL الخاص بطابعك الزمني، "المستخدم: كلمة المرور");

// إضافة إعدادات الطابع الزمني إلى كائن PKCS7
pkcs.TimestampSettings = timestampSettings;
```

هنا، تُحدِّد عنوان URL لخدمة ختم الوقت، والتي ستُحدِّد تلقائيًا الوقت والتاريخ لتوقيعك. يُمكن القيام بذلك مع أو بدون مصادقة.

## الخطوة 4: تحديد موقع التوقيع ومظهره

سنحدد الآن مكان ظهور التوقيع في ملف PDF وأبعاده. يمكنك تخصيص موضع مربع التوقيع في الصفحة، بالإضافة إلى حجمه.

```csharp
// تحديد مظهر التوقيع وموقعه (الصفحة 1، مع المستطيل المحدد)
System.Drawing.Rectangle rect = new System.Drawing.Rectangle(100, 100, 200, 100);
```

هنا، نقوم بتعريف مستطيل يضع التوقيع عند الإحداثيات (100، 100) على الصفحة الأولى من ملف PDF، بعرض 200 وارتفاع 100. يمكنك تغيير هذه القيم لتناسب تصميمك.

## الخطوة 5: توقيع مستند PDF

بعد إعداد كل شيء، حان وقت تطبيق التوقيع الرقمي على ملف PDF. تجمع هذه الخطوة الشهادة والطابع الزمني وتحديد الموقع في أمر واحد بسيط.

```csharp
// توقيع الوثيقة في الصفحة الأولى
signature.Sign(1, "Signature Reason", "Contact", "Location", true, rect, pkcs);
```

وإليك ما يحدث:
- 1: يشير هذا إلى أنه يجب تطبيق التوقيع على الصفحة الأولى.
- "سبب التوقيع": هذا هو المكان الذي يمكنك فيه تحديد سبب توقيعك على المستند.
- "الاتصال": أدخل معلومات الاتصال الخاصة بالموقع.
- "الموقع": حدد موقع المُوقِّع.
- صحيح: تشير هذه القيمة المنطقية إلى ما إذا كان التوقيع مرئيًا في المستند.
- المستطيل: المستطيل الذي حددناه سابقًا يحدد حجم وموضع التوقيع.
- pkcs: يحتوي كائن PKCS7 على إعدادات الشهادة الرقمية والطابع الزمني.

## الخطوة 6: حفظ ملف PDF الموقع

بعد توقيع المستند، كل ما تبقى هو حفظه. يمكنك اختيار اسم جديد للملف للاحتفاظ بالنسختين الأصلية والموقعة.

```csharp
// حفظ مستند PDF الموقع
signature.Save(dataDir + "DigitallySignWithTimeStamp_out.pdf");
```

سيتم الآن حفظ ملف PDF الموقع والمختوم بالتاريخ في الدليل المحدد!

## خاتمة

ها قد انتهيت! لقد نجحتَ في توقيع ملف PDF رقميًا بختم زمني باستخدام Aspose.PDF لـ .NET. تضمن هذه العملية صحة وسلامة مستنداتك، مما يمنحكَ أنت والمستلم راحة البال. تزداد أهمية التوقيعات الرقمية في عالمنا الرقمي اليوم، لذا فإن إتقان هذه العملية مهارة تستحق العناء.

## الأسئلة الشائعة

### هل يمكنني استخدام تنسيق ملف مختلف للشهادة؟  
نعم، ولكن يركز البرنامج التعليمي على استخدام ملف PFX، وهو التنسيق الأكثر شيوعًا للشهادات الرقمية.

### هل أحتاج إلى اتصال بالإنترنت لتطبيق الطابع الزمني؟  
نعم، بما أن الطابع الزمني يتم جلبه من جهة إصدار الطابع الزمني عبر الإنترنت، فستحتاج إلى الوصول إلى الإنترنت.

### هل يمكنني التوقيع على صفحات متعددة في ملف PDF؟  
بالتأكيد! يمكنك تعديل `signature.Sign()` طريقة لاستهداف صفحات متعددة أو المرور عبر جميع الصفحات.

### ماذا يحدث إذا كانت كلمة مرور ملف PFX غير صحيحة؟  
سوف تتلقى استثناءً إذا كانت كلمة المرور خاطئة، لذا تأكد من إدخالها بشكل صحيح.

### هل يمكنني جعل التوقيع غير مرئي؟  
نعم يمكنك المرور `false` الى `Sign` معلمة الرؤية الخاصة بالطريقة لجعل التوقيع غير مرئي.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}