---
"description": "حوّل تدفق الصور إلى PDF بسهولة باستخدام Aspose.PDF لـ .NET مع هذا الدليل المفصل خطوة بخطوة. تعلّم كيفية تحويل الصور إلى PDF بسهولة."
"linktitle": "تحويل تدفق الصور إلى ملف PDF"
"second_title": "مرجع Aspose.PDF لـ API .NET"
"title": "تحويل تدفق الصور إلى ملف PDF"
"url": "/ar/net/programming-with-images/convert-image-stream-to-pdf/"
"weight": 70
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# تحويل تدفق الصور إلى ملف PDF

## مقدمة

هل تساءلت يومًا عن كيفية تحويل تدفق الصور مباشرةً إلى ملف PDF؟ سواء كنت ترغب في أرشفة الصور، أو مشاركة المستندات، أو إعداد العروض التقديمية، فإن تحويل الصور إلى ملفات PDF يُعدّ حيلة قيّمة. لحسن الحظ، باستخدام Aspose.PDF لـ .NET، هذه العملية ليست سهلة فحسب، بل مرنة وفعالة أيضًا.

في هذا البرنامج التعليمي، سنرشدك خطوة بخطوة حول كيفية تحويل تدفق صورة إلى ملف PDF باستخدام Aspose.PDF لـ .NET. سنبدأ بإعداد البيئة اللازمة، ثم نشرح الكود في أجزاء صغيرة، مع شرح كل خطوة بالتفصيل.

## المتطلبات الأساسية

قبل أن نتعمق في الكود، دعنا نتأكد من أن لديك كل ما تحتاجه للمتابعة:

1. Aspose.PDF لـ .NET: أولاً، ستحتاج إلى تثبيت مكتبة Aspose.PDF. يمكنك شراؤها [هنا](https://purchase.aspose.com/buy)أو إذا كنت تريد فقط تجربته، فاحصل على [نسخة تجريبية مجانية](https://releases.aspose.com/pdf/net/).
2. بيئة التطوير: ستحتاج إلى بيئة تطوير متكاملة مثل Visual Studio مع تثبيت .NET.
3. ترخيص ساري المفعول: للاستفادة الكاملة من إمكانات Aspose.PDF، تحتاج إلى ترخيص ساري المفعول. يمكنك التقدم بطلب للحصول على [رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) إذا لم يكن لديك واحدة بعد.
4. المعرفة الأساسية بلغة C#: نظرًا لأن هذا البرنامج التعليمي يعتمد على لغة C#، فمن المفيد أن يكون لديك بعض الألفة مع اللغة.

## استيراد الحزم

قبل كتابة الكود، عليك استيراد مساحات الأسماء اللازمة. هذه المساحات ضرورية للعمل مع تدفقات الملفات، وتدفقات الذاكرة، ومستند PDF نفسه.

```csharp
using System.IO;
using Aspose.Pdf;
```

الآن، دعنا نقوم بتقسيم العملية خطوة بخطوة، حتى تتمكن من متابعتها بسهولة.

## الخطوة 1: تعيين مسار الدليل

أول ما علينا فعله هو تحديد مسار المجلد الذي يُخزَّن فيه ملف صورتك. هذا يضمن إمكانية الوصول إلى الصورة بشكل صحيح للتحويل.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

يستبدل `"YOUR DOCUMENT DIRECTORY"` مع الدليل الفعلي الذي يوجد فيه ملف صورتك. هذا سيسمح للبرنامج بتحديد موقع الصورة ومعالجتها للتحويل.

## الخطوة 2: إنشاء مستند PDF

بعد ذلك، ننشئ مستند PDF فارغًا سيحتوي على صورتنا. باستخدام `Aspose.Pdf.Document` منشئ، نقوم بتهيئة مستند فارغ.

```csharp
Aspose.Pdf.Document pdf1 = new Aspose.Pdf.Document();
```

هنا، نقوم بإنشاء مثيل جديد `Document` باستخدام مكتبة Aspose.PDF. سيحتوي هذا الكائن على بنية PDF، حيث يمكننا إدراج الصورة لاحقًا.

## الخطوة 3: إضافة صفحة جديدة إلى ملف PDF

بعد إنشاء المستند، نحتاج إلى إضافة صفحة إليه. هنا سيتم وضع صورتنا.

```csharp
Aspose.Pdf.Page sec = pdf1.Pages.Add();
```

ال `Pages.Add()` تُنشئ هذه الطريقة صفحة جديدة داخل مستند PDF. تصوّر هذه الصفحة كلوحة فارغة تُوضع عليها الصورة.

## الخطوة 4: فتح ملف الصورة كدفق

قبل إدراج الصورة في ملف PDF، نحتاج إلى قراءتها من نظام الملفات. نقوم بذلك عن طريق إنشاء `FileStream` لفتح ملف الصورة.

```csharp
FileStream fs = File.OpenRead(dataDir + "aspose.jpg");
```

ال `FileStream` يقرأ ملف الصورة من الدليل المحدد في `dataDir`تأكد من صحة اسم ملف الصورة - هنا نستخدم `aspose.jpg`.

## الخطوة 5: تحويل الصورة إلى مصفوفة بايت

للتلاعب بالصورة، نقوم بتحويلها إلى مصفوفة بايتات، والتي يمكن معالجتها بسهولة أكبر بواسطة البرنامج.

```csharp
byte[] data = new byte[fs.Length];
fs.Read(data, 0, data.Length);
```

نقوم بإنشاء مصفوفة بايتات تحتوي على بيانات ملف الصورة بالكامل. `fs.Read()` تقوم الطريقة بقراءة بيانات الصورة في المصفوفة، والتي سيتم تمريرها بعد ذلك للتحويل.

## الخطوة 6: إنشاء كائن MemoryStream

بعد تحويل الصورة إلى مصفوفة بايت، نقوم بتحميلها إلى `MemoryStream`. هذه الخطوة ضرورية لإدراج الصورة في ملف PDF.

```csharp
MemoryStream ms = new MemoryStream(data);
```

من خلال تخزين بيانات الصورة في `MemoryStream`نُهيئها لإضافتها إلى مستند PDF. يعمل هذا التدفق كذاكرة مؤقتة وسيطة للصورة.

## الخطوة 7: إنشاء كائن الصورة

الآن، حان الوقت لإنشاء كائن صورة يحمل الصورة التي نخطط لإضافتها إلى ملف PDF.

```csharp
Aspose.Pdf.Image imageht = new Aspose.Pdf.Image();
```

ال `Image` يتم استخدام الفئة من مكتبة Aspose.PDF لتمثيل الصورة التي سيتم تضمينها في ملف PDF. `imageht` الكائن هو في الأساس عنصر نائب للصورة في ملف PDF.

## الخطوة 8: تعيين مصدر الصورة كـ MemoryStream

الآن بعد أن أصبح لدينا كائن الصورة وبيانات الصورة في مجرى الذاكرة، يمكننا ربط الاثنين معًا.

```csharp
imageht.ImageStream = ms;
```

لقد وضعنا `ImageStream` خاصية كائن الصورة إلى مجرى الذاكرة الذي يحتوي على بيانات الصورة. هذا يُحدد مصدر الصورة في مستند PDF.

## الخطوة 9: إضافة الصورة إلى صفحة PDF

بعد أن أصبح كائن الصورة جاهزًا، نضيفه إلى مجموعة الفقرات الخاصة بالصفحة التي أنشأناها سابقًا.

```csharp
sec.Paragraphs.Add(imageht);
```

ال `Paragraphs.Add()` تقوم الطريقة بإدراج كائن الصورة في الصفحة، والتي ستعرض الصورة عند فتح ملف PDF.

## الخطوة 10: احفظ ملف PDF

وأخيرًا، نحفظ مستند PDF مع الصورة المضمنة في الداخل.

```csharp
pdf1.Save(dataDir + "ConvertMemoryStreamImageToPdf_out.pdf");
```

ال `Save()` تُخرِج هذه الطريقة ملف PDF بالاسم المُحدَّد. هنا، يُحفَظ ملف PDF باسم `ConvertMemoryStreamImageToPdf_out.pdf` في نفس الدليل مثل ملف الصورة.

## الخطوة 11: إغلاق MemoryStream

من الأفضل دائمًا إغلاق التدفقات بمجرد الانتهاء منها لتحرير الموارد.

```csharp
ms.Close();
```

إغلاق `MemoryStream` يحرر الذاكرة التي كان يستخدمها، وهو أمر ضروري لإدارة الموارد بكفاءة.

## خاتمة

يُعد تحويل تدفق الصور إلى ملف PDF باستخدام Aspose.PDF لـ .NET طريقةً مرنةً وفعّالةً للغاية لتحويل الصور إلى PDF. سواءً كنت تعمل على دفعاتٍ كبيرةٍ من الصور أو ملفٍّ واحدٍ فقط، يُقدّم هذا الدليل المُفصّل طريقةً واضحةً وسهلةَ التنفيذ. بهذه الطريقة، يُمكنك دمج وظيفة تحويل الصور إلى PDF في تطبيقاتك بسهولة.

## الأسئلة الشائعة

### ما هي تنسيقات الملفات التي يدعمها Aspose.PDF لتحويل الصور؟
يدعم Aspose.PDF تنسيقات الصور المختلفة مثل JPEG وPNG وBMP وGIF والمزيد.

### هل يمكنني إضافة صور متعددة إلى ملف PDF واحد باستخدام هذه الطريقة؟
نعم، يمكنك تكرار عملية إضافة الصور إلى نفس ملف PDF عن طريق إنشاء ملفات إضافية `Image` الأشياء لكل صورة.

### هل استخدام Aspose.PDF مجاني؟
Aspose.PDF هو منتج مدفوع، ولكن يمكنك تجربته مجانًا عن طريق تنزيله [نسخة تجريبية](https://releases.aspose.com/pdf/net/).

### كيف أحصل على ترخيص مؤقت لـ Aspose.PDF؟
يمكنك التقدم بطلب للحصول على [رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) لأغراض الاختبار.

### هل يدعم Aspose.PDF ملفات PDF المحمية بكلمة مرور؟
نعم، يسمح لك Aspose.PDF بإنشاء ملفات PDF محمية بكلمة مرور ومعالجتها.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}