---
"description": "تعرّف على كيفية إضافة صور إلى ملف PDF برمجيًا باستخدام Aspose.PDF لـ .NET. دليل خطوة بخطوة، ومثال على الكود، وأسئلة شائعة مُضمنة لضمان سهولة التنفيذ."
"linktitle": "إضافة صورة في ملف PDF"
"second_title": "مرجع Aspose.PDF لـ API .NET"
"title": "إضافة صورة في ملف PDF"
"url": "/ar/net/programming-with-images/add-image/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# إضافة صورة في ملف PDF

## مقدمة

هل تساءلت يومًا عن كيفية إدراج صورة في ملف PDF برمجيًا؟ سواء كنت تُطوّر نظامًا لإنشاء المستندات أو تُضيف عناصر هوية تجارية إلى ملفات PDF، فإن Aspose.PDF لـ .NET يُسهّل الأمر بشكل كبير. لنبدأ بشرح خطوة بخطوة حول كيفية إضافة صورة إلى ملف PDF باستخدام Aspose.PDF لـ .NET.

## المتطلبات الأساسية

قبل القفز إلى الكود، دعنا نلقي نظرة سريعة على المتطلبات الأساسية التي تحتاجها للبدء:

- Aspose.PDF لمكتبة .NET: قم بتنزيل أحدث إصدار وتثبيته من [هنا](https://releases.aspose.com/pdf/net/).
- بيئة تطوير .NET: Visual Studio أو أي بيئة تطوير متكاملة أخرى من اختيارك.
- المعرفة الأساسية بلغة C#: الإلمام ببرمجة C# الأساسية ومبادئ البرمجة الكائنية التوجه.
- ملفات PDF والصور: ملف PDF نموذجي وصورة ليتم إدراجها.

## استيراد الحزم المطلوبة

لبدء العمل مع Aspose.PDF، عليك استيراد مساحات الأسماء اللازمة. إليك كيفية القيام بذلك:

```csharp
using System.IO;
using Aspose.Pdf;
using System;
```

ستساعدك هذه الواردات على التفاعل مع مستندات PDF، ومعالجة محتوياتها، والتعامل مع تدفقات الملفات بشكل فعال.

الآن، دعنا نقوم بتقسيم مهمة إضافة صورة إلى مستند PDF إلى خطوات سهلة المتابعة.

## الخطوة 1: إعداد مسار المستند وفتح ملف PDF

قبل إضافة الصورة، عليك أولاً تحديد موقع ملف PDF وفتحه. إليك الكود اللازم:

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// فتح المستند
Document pdfDocument = new Document(dataDir + "AddImage.pdf");
```
ال `Document` تُستخدم الفئة من Aspose.PDF لفتح ملف PDF موجود والعمل عليه. ستحتاج إلى تحديد مسار المجلد الذي يوجد فيه ملف PDF.

## الخطوة 2: تحديد إحداثيات الصورة

لوضع الصورة بشكل صحيح في ملف PDF، عليك تحديد إحداثيات مكان ظهورها. يمكنك القيام بذلك بتحديد الزاويتين السفلية اليسرى والعلوية اليمنى لمستطيل الصورة.

```csharp
// تعيين الإحداثيات
int lowerLeftX = 100;
int lowerLeftY = 100;
int upperRightX = 200;
int upperRightY = 200;
```
تُحدد هذه الإحداثيات مكان وضع الصورة على الصفحة. تُمثل الإحداثيات السفلية اليسرى (100، 100) نقطة البداية، بينما تُحدد الإحداثيات العلوية اليمنى (200، 200) حجم الصورة ونقطة نهايتها.

## الخطوة 3: حدد الصفحة لإدراج الصورة

بعد ذلك، عليك تحديد الصفحة التي تريد إضافة الصورة إليها في ملف PDF. يتيح لك Aspose.PDF الوصول إلى أي صفحة في المستند باستخدام الفهرسة الصفرية.

```csharp
// احصل على الصفحة التي تحتاج إلى إضافة الصورة إليها
Page page = pdfDocument.Pages[1];
```
في هذا المثال، نضيف الصورة إلى الصفحة الأولى من ملف PDF (تشير الصفحات[1] إلى الصفحة الأولى لأنها فهرسة تعتمد على صفحة واحدة).

## الخطوة 4: تحميل الصورة في مجرى

الآن، قم بتحميل الصورة من الدليل الخاص بك إلى مجرى حتى يمكن معالجتها وإدراجها في ملف PDF.

```csharp
// تحميل الصورة في التدفق
FileStream imageStream = new FileStream(dataDir + "aspose-logo.jpg", FileMode.Open);
```
ال `FileStream` تُستخدم الفئة لفتح ملف الصورة. ملف الصورة (`aspose-logo.jpg`) يتم تحميله من الدليل المحدد وفتحه في وضع القراءة (`FileMode.Open`).

## الخطوة 5: إضافة الصورة إلى صفحة PDF

بمجرد تحميل الصورة إلى مجرى، يمكنك إضافتها إلى موارد صفحة PDF.

```csharp
// إضافة صورة إلى مجموعة الصور في موارد الصفحة
page.Resources.Images.Add(imageStream);
```
تُضيف هذه الخطوة الصورة إلى مجموعة موارد الصفحة. ستكون الصورة الآن متاحة للعرض على الصفحة.

## الخطوة 6: حفظ حالة الرسومات الحالية

قبل وضع الصورة على الصفحة، يجب عليك حفظ حالة الرسومات الحالية باستخدام `GSave` يضمن هذا أن أي تحويلات يتم تطبيقها على الصورة لن تؤثر على بقية المستند.

```csharp
// استخدام عامل GSave: يحفظ هذا العامل حالة الرسومات الحالية
page.Contents.Add(new Aspose.Pdf.Operators.GSave());
```
ال `GSave` يقوم المشغل بحفظ الإعدادات الرسومية الحالية، مما يسمح لك لاحقًا باستعادتها، مع التأكد من أن وضع الصورة لا يزعج المحتوى الآخر على الصفحة.

## الخطوة 7: تحديد موضع الصورة باستخدام المستطيل والمصفوفة

الآن قم بإنشاء `Rectangle` كائن يحدد المكان الذي سيتم وضع الصورة فيه على الصفحة و `Matrix` للتحكم في الوضع والقياس.

```csharp
// إنشاء كائنات المستطيل والمصفوفة
Aspose.Pdf.Rectangle rectangle = new Aspose.Pdf.Rectangle(lowerLeftX, lowerLeftY, upperRightX, upperRightY);
Matrix matrix = new Matrix(new double[] { rectangle.URX - rectangle.LLX, 0, 0, rectangle.URY - rectangle.LLY, rectangle.LLX, rectangle.LLY });
```
ال `Rectangle` يحدد إحداثيات الصورة على صفحة PDF، و `Matrix` يضمن القياس والموضع الصحيحين.

## الخطوة 8: ربط المصفوفة لوضع الصورة

ال `ConcatenateMatrix` يتم استخدام المشغل لتطبيق تحويل المصفوفة، مما يضمن وضع الصورة بشكل صحيح.

```csharp
// استخدام عامل ConcatenateMatrix (مصفوفة متسلسلة): يحدد كيفية وضع الصورة
page.Contents.Add(new Aspose.Pdf.Operators.ConcatenateMatrix(matrix));
```
يضمن هذا التحويل وضع الصورة في الموقع الصحيح على الصفحة باستخدام قيم المصفوفة المحددة.

## الخطوة 9: عرض الصورة على صفحة PDF

وأخيرا، استخدم `Do` المشغل لعرض الصورة فعليًا على صفحة PDF.

```csharp
XImage ximage = page.Resources.Images[page.Resources.Images.Count];
// استخدام عامل Do: يقوم هذا العامل برسم الصورة
page.Contents.Add(new Aspose.Pdf.Operators.Do(ximage.Name));
```
ال `Do` يقوم المشغل برسم الصورة في الموقع الذي تم تحديده بواسطة تحويل المصفوفة السابق.

## الخطوة 10: استعادة حالة الرسومات

بمجرد إضافة الصورة، قم باستعادة حالة الرسومات السابقة باستخدام `GRestore` المشغل.

```csharp
// استخدام عامل GRestore: يقوم هذا العامل باستعادة حالة الرسومات
page.Contents.Add(new Aspose.Pdf.Operators.GRestore());
```
تضمن هذه الخطوة التراجع عن أي تغييرات تم إجراؤها على حالة الرسومات (مثل التحويلات أو التدرج)، مع الحفاظ على بقية المستند دون تأثير.

## الخطوة 11: حفظ مستند PDF المحدث

وأخيرًا، احفظ ملف PDF الذي يحتوي على الصورة المضافة حديثًا إلى ملف.

```csharp
dataDir = dataDir + "AddImage_out.pdf";
// حفظ المستند المحدث
pdfDocument.Save(dataDir);
```
ال `Save` يتم استخدام الطريقة لحفظ مستند PDF مع الصورة المضافة، ويتم حفظ الملف المحدث باسم "AddImage_out.pdf".

## خاتمة

إدراج صورة في ملف PDF باستخدام Aspose.PDF لـ .NET سهلٌ للغاية عند شرحه خطوة بخطوة. باستخدام عوامل تشغيل مختلفة مثل `GSave`، `ConcatenateMatrix`، و `Do`يمكنك بسهولة التحكم في وضع الصور وعرضها داخل مستندات PDF. تُعد هذه التقنية أساسية لتخصيص ملفات PDF وإضافة شعارات أو علامات مائية أو أي صور أخرى إليها.

## الأسئلة الشائعة

### هل يمكنني إضافة صور متعددة إلى صفحة واحدة؟  
نعم، يمكنك إضافة صور متعددة إلى نفس الصفحة عن طريق تكرار خطوات تحميل ووضع كل صورة.

### كيف يمكنني التحكم بحجم الصورة المدرجة؟  
يتم التحكم في حجم الصورة عن طريق إحداثيات المستطيل (`lowerLeftX`، `lowerLeftY`، `upperRightX`، `upperRightY`).

### هل يمكنني إدراج أنواع أخرى من الملفات مثل PNG أو GIF؟  
نعم، يدعم Aspose.PDF تنسيقات الصور المختلفة، بما في ذلك PNG، وGIF، وBMP، وJPEG.

### هل من الممكن إضافة الصور بشكل ديناميكي؟  
نعم، يمكنك تحميل الصور وإدراجها بشكل ديناميكي عن طريق توفير مسار الملف أو استخدام التدفقات.

### هل يسمح Aspose.PDF بإضافة الصور بكميات كبيرة إلى صفحات متعددة؟  
نعم، يمكنك التنقل بين الصفحات في مستند وإضافة صور إلى صفحات متعددة باستخدام نفس النهج.

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}